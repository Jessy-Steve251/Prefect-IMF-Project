deployments:
  - name: currency-acquisition
    description: Acquire currency exchange rate data
    entrypoint: flows/currency_acquisition_flow.py:currency_acquisition_flow
    work_pool:
      name: Yichen_Test
    pull:
      - prefect.deployments.steps.git_clone:
          id: clone-step
          repository: "{{ prefect.blocks.github-repository.imf-github-repo.repository_url }}"
          branch: "{{ prefect.blocks.github-repository.imf-github-repo.reference }}"
          credentials:
            access_token: "{{ prefect.blocks.secret.github-token }}"
      - prefect.deployments.steps.pip_install_requirements:
          directory: "{{ clone-step.directory }}"
          requirements_file: requirements.txt
    schedules:
      - cron: "10 17 17 * *"
        timezone: Europe/Zurich
        active: true

  - name: prepare-batch
    description: Prepare batch data
    entrypoint: flows/prepare_batch_flow.py:prepare_batch_flow
    work_pool:
      name: Yichen_Test
    pull:
      - prefect.deployments.steps.git_clone:
          id: clone-step
          repository: "{{ prefect.blocks.github-repository.imf-github-repo.repository_url }}"
          branch: "{{ prefect.blocks.github-repository.imf-github-repo.reference }}"
          credentials:
            access_token: "{{ prefect.blocks.secret.github-token }}"
      - prefect.deployments.steps.pip_install_requirements:
          directory: "{{ clone-step.directory }}"
          requirements_file: requirements.txt
    schedules:
      - cron: "30 17 17 * *"
        timezone: Europe/Zurich
        active: true

  - name: process-batch
    description: Process batch data
    entrypoint: flows/process_batch_flow.py:process_batch_flow
    work_pool:
      name: Yichen_Test
    pull:
      - prefect.deployments.steps.git_clone:
          id: clone-step
          repository: "{{ prefect.blocks.github-repository.imf-github-repo.repository_url }}"
          branch: "{{ prefect.blocks.github-repository.imf-github-repo.reference }}"
          credentials:
            access_token: "{{ prefect.blocks.secret.github-token }}"
      - prefect.deployments.steps.pip_install_requirements:
          directory: "{{ clone-step.directory }}"
          requirements_file: requirements.txt
    schedules:
      - cron: "30 17 17 * *"
        timezone: Europe/Zurich
        active: true

  - name: complete-batch-pipeline
    description: Run complete batch pipeline
    entrypoint: flows/complete_batch_pipeline.py:complete_batch_pipeline
    work_pool:
      name: Yichen_Test
    pull:
      - prefect.deployments.steps.git_clone:
          id: clone-step
          repository: "{{ prefect.blocks.github-repository.imf-github-repo.repository_url }}"
          branch: "{{ prefect.blocks.github-repository.imf-github-repo.reference }}"
          credentials:
            access_token: "{{ prefect.blocks.secret.github-token }}"
      - prefect.deployments.steps.pip_install_requirements:
          directory: "{{ clone-step.directory }}"
          requirements_file: requirements.txt
    schedules:
      - cron: "30 17 17 * *"
        timezone: Europe/Zurich
        active: true